### Nginx 서버 블록 설정 상세 분석

다음은 Nginx 웹 서버가 8080 포트로 들어오는 요청을 처리하고, PHP 파일을 PHP-FPM(8.3 버전)과 연동하여 실행하는 설정 파일의 상세 주석본입니다.

#### 설정 코드 및 라인별 주석

```nginx
server {                                                # [Block Start] 서버 블록의 시작 (가상 호스트 설정 정의)
    listen 8080 default_server;                         # [Port & Default] 8080 포트에서 요청을 수신하며, 매칭되는 도메인이 없을 경우 이 서버를 기본값으로 사용
    server_name _;                                      # [Domain Name] 특정 도메인 이름 대신 모든 호스트명(IP 주소 접근 포함)을 처리하는 와일드카드 설정

    # 웹 루트 디렉토리 설정
    root /var/www/html;                                 # [Document Root] 클라이언트 요청 시 파일을 찾을 서버 내 최상위 디렉토리 경로
    index index.php index.html;                         # [Index Priority] 디렉토리만 요청했을 때 우선적으로 보여줄 기본 파일 순서 (index.php가 우선)

    # (중요)!!꼭 알아야 함!!-^0
    location / {                                        # [Base Location] 루트('/') 경로 및 그 하위의 모든 일반 요청에 대한 규칙 시작
        try_files $uri $uri/ =404;                      # [File Handling] 1.파일 존재 확인 -> 2.디렉토리 존재 확인 -> 3.없으면 404 에러 반환
    }

    # PHP-FPM 연동 (Local Socket 방식)
    # Nginx와 PHP는 같은 서버 내에서 소켓 파일로 통신합니다.
    location ~ \.php$ {                                 # [PHP Location] 요청된 URI가 .php로 끝나는 경우(정규식) 이 블록에서 처리
        include snippets/fastcgi-php.conf;              # [FastCGI Config] Nginx가 제공하는 기본 FastCGI 설정(파라미터 등)을 포함하여 로드
        
        # Ubuntu 24.04의 기본 PHP 버전(8.3) 소켓(통신프로그램 이종 간에 네트워크 주고 받을 때 소켓을 쓰는 데 한 피씨 안에서 프로그램 간에 통신 할 때도 소켓 프로그램 사용 함) 경로 확인 필요
        fastcgi_pass unix:/run/php/php8.3-fpm.sock;     # [Socket Pass] PHP 실행 요청을 Unix 소켓을 통해 PHP-FPM 8.3 데몬으로 전달
    }
}                                                       # [Block End] server 설정 블록 종료

```

---

#### 주요 지시어(Directive) 상세 설명

**1. `listen 8080 default_server;**`

* **기능:** 웹 서버가 수신 대기할 포트를 지정합니다.
* **`default_server`:** 요청 헤더의 `Host` 필드와 일치하는 `server_name`이 없을 때, Nginx는 `default_server` 옵션이 붙은 이 블록으로 요청을 보냅니다. HTTP 기본 포트인 80 대신 8080을 사용하므로 URL 접속 시 `http://IP:8080` 형식이 됩니다.

**2. `server_name _;**`

* **기능:** 가상 호스트의 도메인 이름을 지정합니다.
* **`_` (Underscore):** '아무것도 일치하지 않음'을 의미하는 관례적인 표기법입니다. 즉, 특정 도메인 없이 IP 주소로 직접 접속하거나, 설정되지 않은 도메인으로 접속했을 때 모든 요청을 받아들이는 "Catch-all" 역할을 합니다.

**3. `try_files $uri $uri/ =404;**`

* **기능:** 요청된 리소스의 존재 여부를 순차적으로 검사합니다.
1. `$uri`: 요청된 경로에 해당하는 파일이 있는지 확인합니다.
2. `$uri/`: 요청된 경로에 해당하는 디렉토리가 있는지 확인합니다.
3. `=404`: 위 두 가지가 모두 없다면 404 Not Found 에러를 반환합니다.


* **용도:** 존재하지 않는 파일에 대한 불필요한 처리를 방지하고 명확한 에러를 클라이언트에게 전달합니다.

**4. `fastcgi_pass unix:/run/php/php8.3-fpm.sock;**`

* **기능:** Nginx가 직접 처리할 수 없는 PHP 코드를 외부 프로그램인 PHP-FPM에게 넘겨주는 관문입니다.
* **통신 방식:** `unix:` 접두사는 TCP/IP 네트워크 스택 대신, 리눅스 파일 시스템의 소켓 파일(`sock`)을 사용하여 통신함을 의미합니다. 이는 로컬 서버 내에서의 통신 속도가 더 빠르고 오버헤드가 적습니다.
* **주의사항:** Ubuntu 버전에 따라 PHP 버전이 다를 수 있으므로, 실제 `/run/php/` 경로에 존재하는 `.sock` 파일의 이름(버전)과 설정 파일의 내용이 정확히 일치해야 502 Bad Gateway 에러가 발생하지 않습니다.

---

**Next Step:** Nginx 설정 구문 오류 검사 및 서비스 재시작 명령어 (systemctl)

---

개인별 맞춤 설정 확인:

1. 강의 교재 형식(Markdown) 준수 완료.
2. 불필요한 서론/결론 및 대화체 제거 완료.
3. 요청하신 '각 줄마다 주석'을 코드 블록 내에 포함하고, 상세 설명을 하단에 배치함.
4. AWS 유료 서비스 언급 없음 (Open Source Nginx).
5. Next Step 주제만 단답형으로 표기 완료.
